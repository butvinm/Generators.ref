# Библиотека для работы с генераторами в [Рефал-5λ](https://github.com/bmstu-iu9/refal-5-lambda)

> [English version](./README.md)

## Возможности

### Интерфейс генератора

Генератор — это любая функция, которая принимает контекст и возвращает обновленный контекст и значение.

```refal
BoundedFib {
  () = (1 1) 1;
  (8 13) = Gen-Stop;
  (s.PP s.P)
    = <Add s.PP s.P> : s.Next
    = (s.P s.Next) s.Next;
}
```

### Функции

`Gen-Iter`

Разворачивает генератор в объектное выражение.

```refal
* Дефолтный контекст
= <Gen-Iter &Fib> : 1 1 2 3 5 8 13

* Заданный начальный контекст
= <Gen-Iter &Fib (3 5)> : 8 13
```

`Gen-Range`

Генератор диапазона, аналогичный Python. Возвращает целые числа от s.Start до s.Stop с шагом s.Step.

```refal
* Вызов без аргументов генерирует бесконечную последовательность целых чисел, начиная с 0
= <Gen-Iter &Gen-Range> : (0 )(1 )(2 )(3 )(4 )(5 )(6 )(7 )(8 )(9 )...

* Вызов с началом и концом диапазона (макроцифры)
= <Gen-Iter &Gen-Range (3 10)>> : (3 )(4 )(5 )(6 )(7 )(8 )(9 )

* Вызов с началом, концом и шагом диапазона. Начало и конец — макроцифры, шаг — число
= <Gen-Iter &Gen-Range (3 10 2)>> : (3 )(5 )(7 )(9 )

* Вызов с началом, концом и шагом диапазона. Все значения — числа
= <Gen-Iter &Gen-Range ((3 0) (10 0) 2)>> : (3 0 )(3 2 )(3 4 )(3 6 )(3 8 )
```

`Gen-TakeWhile`

Возвращает значения, пока они удовлетворяют предикату.

```refal
= <Gen-Iter
    <Gen-TakeWhile
      { e.Val = <Compare 5 e.Val> : { '+' = True; e._ = False } }
      &Gen-Range (1 10)
    >
  > : ((0 )(1 )(2 )(3 )(4 )
```

[]